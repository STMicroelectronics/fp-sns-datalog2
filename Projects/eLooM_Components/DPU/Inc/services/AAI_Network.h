/**
  ********************************************************************************
  * @file    AAI_Network.h
  * @author  STMicroelectronics - AIS - MCD Team
  * @version 1.0.0
  * @date    Oct 21, 2022
  *
  * @brief Abstract class for AI network generated by X-CUBE-AI.
  *
  * This class implement the interface ::IAI_Network_t and is the base class
  * to the AI Network wrapper classes generated by X-CUBE-AI.
  *
  ********************************************************************************
  * @attention
  *
  * Copyright (c) 2021 STMicroelectronics
  * All rights reserved.
  *
  * This software is licensed under terms that can be found in the LICENSE file in
  * the root directory of this software component.
  * If no LICENSE file comes with this software, it is provided AS-IS.
  ********************************************************************************
  */
#ifndef DPU_INC_SERVICES_AAI_NETWORK_H_
#define DPU_INC_SERVICES_AAI_NETWORK_H_

#ifdef __cplusplus
extern "C" {
#endif


#include "IAI_Network.h"
#include "IAI_Network_vtbl.h"
#include <stdio.h>

#define MAX_NUM_OF_OUTPUT_BUFFER   2u
#define MAX_NUM_OF_INPUT_BUFFER    1u

/**
  * Create  type name for _AAI_Network.
  */
typedef struct _AAI_Network AAI_Network_t;

/**
  *  AAI_Network internal structure.
  */
struct _AAI_Network
{
  /**
    * Base class object.
    */
  IAI_Network_t super;

  /* AAI_Network variables should be added here. */

  ai_handle network;

  ai_network_report report;

  /* ai model input data */
  ai_buffer ai_input;

  /* ai model output data */
  ai_buffer ai_output[MAX_NUM_OF_OUTPUT_BUFFER];
};


/* Public API declaration */
/**************************/

sys_error_code_t AAI_Network_Bootstrap(AAI_Network_t *_this, const ai_handle *p_activaiton_buff,
                                       const ai_handle *p_weight_buff);

/**
  * Print the content of a network report into a file.
  * This method is not reentrant.
  *
  * @param _this [IN] specifies a pointer to a network object.
  * @param p_channel [IN] specifies the destination file for the report.
  * @return
  */
sys_error_code_t AAI_Network_PrintNetworkInfo(AAI_Network_t *_this, FILE *p_channel);

sys_error_code_t AAI_Network_LogNetworkInfo(AAI_Network_t *_this);

/* Inline functions definition */
/*******************************/


#ifdef __cplusplus
}
#endif

#endif /* DPU_INC_SERVICES_AAI_NETWORK_H_ */
